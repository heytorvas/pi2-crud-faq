<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="br">
<head>
<div th:fragment="header-css">
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<!-- Tell the browser to be responsive to screen width -->
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<!-- Font Awesome -->
	<link rel="stylesheet"
		href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/css/all.min.css">
	<!-- Ionicons -->
	<link rel="stylesheet"
		href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
	<!-- Tempusdominus Bbootstrap 4 -->
	<link rel="stylesheet"
		href="https://cdnjs.cloudflare.com/ajax/libs/tempusdominus-bootstrap-4/5.1.2/js/tempusdominus-bootstrap-4.min.js">
	<!-- iCheck -->
	<link rel="stylesheet"
		href="https://cdnjs.cloudflare.com/ajax/libs/icheck-bootstrap/3.0.1/icheck-bootstrap.min.css">
	<!-- JQVMap -->
	<link rel="stylesheet"
		href="https://cdnjs.cloudflare.com/ajax/libs/jqvmap/1.5.1/jqvmap.min.css">
	<!-- Theme style -->
	<link rel="stylesheet"
		href="https://cdnjs.cloudflare.com/ajax/libs/admin-lte/3.0.4/css/adminlte.min.css">
	<!-- overlayScrollbars -->
	<link rel="stylesheet"
		href="https://cdnjs.cloudflare.com/ajax/libs/overlayscrollbars/1.12.0/css/OverlayScrollbars.min.css">
	<!-- Daterange picker -->
	<link rel="stylesheet"
		href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-daterangepicker/3.0.5/daterangepicker.css">
	<!-- summernote -->
	<link rel="stylesheet" href="plugins/summernote/summernote-bs4.css">
	<!-- Google Font: Source Sans Pro -->
	<link
		href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700"
		rel="stylesheet">
		
	<style>
	
		body {
			overflow-x: hidden;
		}
		.modal{
			top: 37%;
			left: 33%;
		}
		.btn-modal{
			margin: 9px 1rem;
		}
		
	</style>

</div>

</head>
<body>
	<div th:fragment="header">
		<!-- main -->
		<!-- Modal -->
		<div class="modal fade" id="exampleModal" tabindex="-1" role="dialog"
			aria-labelledby="exampleModalLabel" aria-hidden="true"
			data-backdrop="false">
			<div class="modal-dialog" role="document">
				<div class="modal-content">
					<div class="modal-header">
						<h5 class="modal-title" id="exampleModalLabel">Tire suas
							duvidas usando o chatbot</h5>
						<button type="button" class="close" data-dismiss="modal"
							aria-label="Close">
							<span aria-hidden="true">&times;</span>
						</button>
					</div>
					<div class="modal-body">

						<!-- texto do modal -->


						<noscript>
							<h2 style="color: #ff0000">Seems your browser doesn't
								support Javascript! Websocket relies on Javascript being
								enabled. Please enable Javascript and reload this page!</h2>
						</noscript>
						<div
							style="max-height: 220px; height: 220px; padding: 1em 1em; background-color: #fff; border: 1px solid #e5e5e5; -webkit-border-radius: 5px; -moz-border-radius: 5px; border-radius: 5px;"
							id="main-content" class="container">

							<div id="historico-chat" class="row"
								style="max-height: 200px; overflow: auto;">
								<div id="teste2" class="col-md-12">
									<table id="conversation" class="table table-striped">
										<tbody id="greetings">
										</tbody>
									</table>
								</div>
							</div>

						</div>

						<div class="row">
							<div class="col-md-12 ">
								<form class="form-inline">
									<div class="form-group">
										<input type="text" class="form-control"
											placeholder="Digite sua pergunta" id="name">
									</div>
									<button id="send" class="btn btn-primary btn-modal" type="submit">Enviar</button>
								</form>
							</div>
						</div>

						<!-- texto do modal -->

					</div>
				</div>
			</div>
		</div>
		<nav
			class="main-header navbar navbar-expand navbar-white navbar-light">
			<ul class="navbar-nav">
				<li class="nav-item"><a class="nav-link" data-widget="pushmenu"
					href="#" role="button"><i class="fas fa-bars"></i></a></li>
				<li class="nav-item d-none d-sm-inline-block"><a href="/index"
					class="nav-link">In√≠cio</a></li>
				<li class="nav-item d-none d-sm-inline-block"><a href="#"
					class="nav-link">Contato</a></li>
			</ul>

			<form class="form-inline ml-3">
				<div class="input-group input-group-sm">
					<input class="form-control form-control-navbar" type="search"
						placeholder="Pesquisar" aria-label="Search">
					<div class="input-group-append">
						<button class="btn btn-navbar" type="submit">
							<i class="fas fa-search"></i>
						</button>
					</div>
				</div>
			</form>
		</nav>
	</div>

	<div th:fragment="header-js">
		<!-- jQuery -->
		<script
			src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.0/jquery.min.js"></script>
		<!-- jQuery UI 1.11.4 -->
		<script
			src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
		<!-- Resolve conflict in jQuery UI tooltip with Bootstrap tooltip -->
		<script>
			$.widget.bridge('uibutton', $.ui.button)
		</script>
		<!-- Bootstrap 4 -->
		<script
			src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.4.0/js/bootstrap.bundle.min.js"></script>
		<!-- ChartJS -->
		<script
			src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.3/Chart.min.js"></script>
		<!-- Sparkline -->
		<script
			src="https://cdnjs.cloudflare.com/ajax/libs/jquery-sparklines/2.1.2/jquery.sparkline.js"></script>
		<!-- JQVMap -->
		<script
			src="https://cdnjs.cloudflare.com/ajax/libs/jqvmap/1.5.1/jquery.vmap.min.js"></script>
		<script
			src="https://cdnjs.cloudflare.com/ajax/libs/jqvmap/1.5.1/maps/jquery.vmap.brazil.js"></script>
		<!-- jQuery Knob Chart -->
		<script
			src="https://cdnjs.cloudflare.com/ajax/libs/jQuery-Knob/1.2.13/jquery.knob.min.js"></script>
		<!-- daterangepicker -->
		<script
			src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-daterangepicker/3.0.5/moment.min.js"></script>
		<script
			src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-daterangepicker/3.0.5/daterangepicker.js"></script>
		<!-- Tempusdominus Bootstrap 4 -->
		<script
			src="https://cdnjs.cloudflare.com/ajax/libs/tempusdominus-bootstrap-4/5.1.2/js/tempusdominus-bootstrap-4.min.js"></script>
		<!-- Summernote -->
		<script
			src="https://cdnjs.cloudflare.com/ajax/libs/summernote/0.8.12/summernote-bs4.min.js"></script>
		<!-- overlayScrollbars -->
		<script
			src="https://cdnjs.cloudflare.com/ajax/libs/overlayscrollbars/1.12.0/js/OverlayScrollbars.min.js"></script>
		<!-- AdminLTE App -->
		<script
			src="https://cdnjs.cloudflare.com/ajax/libs/admin-lte/3.0.4/js/adminlte.js"></script>
		<!-- AdminLTE dashboard demo (This is only for demo purposes) -->
		<script
			src="https://cdnjs.cloudflare.com/ajax/libs/admin-lte/3.0.4/js/pages/dashboard.js"></script>
		<!-- AdminLTE for demo purposes -->
		<script
			src="https://cdnjs.cloudflare.com/ajax/libs/admin-lte/3.0.4/js/demo.js"></script>

		<script src="/webjars/jquery/jquery.min.js"></script>
		<script src="/webjars/sockjs-client/sockjs.min.js"></script>
		<script src="/webjars/stomp-websocket/stomp.min.js"></script>

		<script>
			var stompClient = null;

			function setConnected(connected) {
				$("#connect").prop("disabled", connected);
				$("#disconnect").prop("disabled", !connected);
				if (connected) {
					$("#conversation").show();
				} else {
					$("#conversation").hide();
				}
				$("#greetings").html("");
			}

			function connect() {
				var socket = new SockJS('/gs-guide-websocket');
				stompClient = Stomp.over(socket);
				stompClient
						.connect(
								{},
								function(frame) {
									setConnected(true);
									console.log('Connected: ' + frame);
									stompClient
											.subscribe(
													'/topic/greetings',
													function(greeting) {
														showGreeting(JSON
																.parse(greeting.body).content);
													});
								});
			}

			function disconnect() {
				if (stompClient !== null) {
					stompClient.disconnect();
				}
				setConnected(false);
				console.log("Disconnected");
			}

			function sendName() {
				stompClient.send("/app/hello", {}, JSON.stringify({
					'name' : $("#name").val()
				}));
			}

			function showGreeting(message) {
				var userID = document.getElementById('userID').innerText;
				$("#greetings").append(
						"<tr><td> " + userID + ": " + $("#name").val() + "</td></tr><br />");
				$("#greetings").append(
						"<tr><td> UniBot: " + message + "</td></tr>");
				var objDiv = document.getElementById("historico-chat");
				objDiv.scrollTop = objDiv.scrollHeight;
				
				$('#name').val('');
			}

			$(function() {

				connect();

				$("form").on('submit', function(e) {
					e.preventDefault();

				});

				$("#send").click(function() {
					sendName();

				});

			});
		</script>
	</div>
</body>
</html>